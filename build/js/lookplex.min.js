function loginFacebook(){console.log("--------------------Inside-----Before-LoginFacebook--"),FB.login(function(e){AuthStates.facebook=e,chooseAuthProvider(),$user.platform="facebook",$user.fbidRequest=e.authResponse.userID,$user.token=e.authResponse.accessToken},{scope:"email"}),saveCust()}function facebookLogin2(){console.log("--------------Inside facebooklogin 2------------------"),$("#login").modal("hide"),FB.login(function(e){if(e.authResponse){var o=FB.getAuthResponse().accessToken;console.log("Welcome!  Fetching your information.... "),FB.api("/me?fields=id,name,picture,gender,email",function(e){console.log("Good to see you, "+e.name+"."),console.log("Response is ------------"+e),console.log("JSON Response is ------------"+JSON.stringify(e)),console.log("JSON Response is ------------"+JSON.stringify(e.authResponse)),$user.fbidRequest=e.id,$user.token=o,$user.platform="facebook",$user.displayName=e.name,saveCust()})}else console.log("User cancelled login or did not fully authorize.")},{scope:"email"})}function clearUser(){$user.displayName=null,$user.image=null,$user.platform=null,$user.token=null,$user.gpid=null,$user.fbid=null}function onSignInCallback(e){$user.displayName||(console.log($user.displayName),console.log(e),delete e["g-oauth-window"],AuthStates.google=e,console.log(e),$user.token=e.access_token,chooseAuthProvider())}function chooseAuthProvider(){console.log("----------------------------------------------Inside chooseAuthProvider"),console.log(AuthStates),(AuthStates.google||AuthStates.facebook)&&(AuthStates.google.access_token?(console.log(AuthStates.google.access_token),gapi.client.load("plus","v1",apiClientLoaded)):AuthStates.facebook&&(console.log("----------------------------------------------AuthStates.facebook"),"connected"===AuthStates.facebook.status&&(console.log("----------------------------------------------AuthStates.facebook.status === 'connected'"),FB.api("/me?fields=id,name,picture,gender,email",function(e){$user.displayName=e.name,$user.image=e.picture.data.url,$user.platform="facebook",render_umenu(),$("#discard").click(),console.log("------------------------After user is logged in -----------------------------")}))),$(document).find("button.close")[0].click())}function apiClientLoaded(){console.log("------------------apiClientLoaded"),gapi.client.plus.people.get({userId:"me"}).execute(handleResponse)}function handleResponse(e){console.log("------------------handleResponse"),$user.displayName=e.displayName,$user.image=e.image.url,$user.platform="gplus",$user.token=AuthStates.google.access_token,$user.gpid=e.result.id,delete $user.fbid,console.log($user),saveCust(),$user.displayName=e.displayName,render_umenu(),$("#discard").click()}function render_umenu(){if($user.displayName){console.log("---------------------------------------dispaly--logged in");var e=new TopAccMenu;e.render()}else console.log("---------------------------------------dispaly--Not logged in"),$(".top-menu>a[data-target=#logout]").attr({"data-target":"#login"}).html("Log In")}function rcp(e){for(var o=e.split(",").length;o>1;)e=e.replace(","," &#8226; "),o--;return e.replace("sp","Spa").replace("sa","Salon").replace("gy","Gym").replace("bpp","Body piercing").replace("bp","Beauty Parlour").replace("bph","Beauty Parlour At Home").replace("skc","Skin Care").replace("slc","Slimming Center").replace("pbm","Party & Bridal Makeup").replace("dt","Dietician").replace("ya","Yoga & Aerobics").replace("na","Nail Art").replace("md","Mehendi").replace("tt","Tattoo").replace("ot","Others")}function highlight(e){return"<strong>"+e+"</strong>"}function rt(e){return void 0==e||""==e||"null to null"==e||null==e||-1!=e.indexOf("OFF")?"Closed":($time=e.replace("am"," AM").replace("pm"," PM").replace("-","  to  ").split(""),$time[15]=":"+$time[15],$time[2]=":"+$time[2],$time.join(""))}function saveCust(){return $.ajax({url:$ROOT_URL+"/saveCust",type:"POST",contentType:"application/x-www-form-urlencoded",data:$user,xhrFields:{withCredentials:!0},parse:function(e,o){},success:function(e,o,t){render_umenu(),location.reload()}}).fail(function(e){console.log(e)})}function notifications(e){var o=new Date,t="",s=e+"",n=0;if(s.indexOf("OFF")>=0)t="Closed Today";else{var a=new Date;a.setHours(e.substr(0,2)),a.setMinutes(e.substr(2,2));var i=new Date,r=parseInt(e.substr(7,2))+12;i.setHours(r),i.setMinutes(e.substr(9,2)),n=i.getHours(),"am"==e.substr(11,2).toLowerCase()&&(console.log(e.substr(9,2)+"time.substr(9,2)"),"12"==e.substr(7,2)?(i.setHours(23),i.setMinutes(59),n=23,i.setDate(o.getDate())):(i.setHours(i.getHours()+12),n=r+24)),a>o?t="Opening in &nbsp; <b>"+parseInt((a-o)/1e3/60/60)+" Hours "+parseInt((a-o)/1e3/60%60)+" Mins</b>":o>=a?o>i?(console.log("date > closetime"),t="Closed for Today"):i>=o&&(console.log("date <= closetime"),t=n-o.getHours()<1?i.getMinutes()>o.getMinutes()?"Closing in next &nbsp;<b>"+parseInt((i-o)/1e3/60/60)+" Hours "+parseInt((i-o)/1e3/60%60)+" Mins</b>":"Closed for Today":"Open for next &nbsp;<b>"+parseInt((i-o)/1e3/60/60)+" Hours "+parseInt((i-o)/1e3/60%60)+" Mins</b>"):o.getHours()==a.getHours()&&(t="Open Now")}return t}function clickedondate(e){console.log(e),$booking.date=e,$("#dd").val($booking.date),$("#datelist").hide()}function afterProgress(e){console.log(e),$(".bookcontents").removeClass("showing"),$(".bookcontents").eq(e).addClass("showing"),$(".header-title h3").hide(),$(".header-title h3").eq(e).show(),$("#bar").animate({width:25*(e+1)+"%"},500),$("#footerbtn>div").hide(),$("#footerbtn>div").eq(e).show(),e>0?$("#backbook").show():$("#backbook").hide()}$ROOT_URL="https://storeapi.lookplex.com/ws/masnepservice",$SER_URL="https://storeapi.lookplex.com/ws/service",$uploadPoint="https://storeapi.lookplex.com/ws/server/uploads/",$domain="lookplex.com",$ratecardnotrenderd=!0,$storephotodnotrenderd=!0,$reviewnotrenderd=!0,$mapnotrenderd=!0,$lat=28.60659,$log=77.29368,$flag=!0;var AuthStates={google:null,facebook:null};$user={displayName:null,image:null,platform:null,access_token:"",fbid:"",gpid:""},$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip(),$(this).scrollTop(0),$("#otp").on("hidden.bs.modal",function(){$progress=0,$("#dd").val(""),$("#tt").val(""),$(".cm1").val(""),$("#mn").val(""),$(".bookcontents").removeClass("showing"),$("#backbook").hide(),$("#bd").addClass("hidden")}),$.ajax({url:$ROOT_URL+"/isloggedin",type:"GET",cache:!1,xhrFields:{withCredentials:!0},success:function(e){$user.displayName=e,console.log("::"+$user.displayName+"::"),render_umenu()},error:function(e){console.log("error "+e),$user.displayName=null}})}),$(document).ready(function(e){function o(e){!$(e).length>0?$.get("templates/login-signup-modal.txt",function(o,t,s){$("body").prepend(o),$(e).modal("show")}):$(e).modal("show")}$(document).keydown(function(e){13==e.which&&($("#otp").data("bs.modal")||{}).isShown&&$("#nextbook").click()}),$(document).on("click","#headersearch",function(){$(".categories-list").slideUp(),$(".location-suggestion").text()&&$("#headersearch").length>2&&$(".location-suggestion").slideDown()}),$(document).on("click","button.login-btn",function(){"facebook"==$(this).attr("id")&&facebookLogin2()}),$(document).on("click",".top-menu>a",function(e){if(e.preventDefault(),"#login"==$(this).attr("data-target"))o("#login");else if("#hiw"==$(this).attr("data-target"))$(".how-it-works").is(":visible")?$(".how-it-works").slideUp():((new HowItWorks).render(),$(".how-it-works").slideDown());else if("#faq"==$(this).attr("data-target"))o("#faq");else{if("#freelisting"==$(this).attr("data-target"))return window.location="#/listing",!0;"#logout"==$(this).attr("data-target")&&(new TopAccMenu).show_menu()}}),$(document).on("click",".close",function(){$(".how-it-works").slideUp()}),$(".faq-menu>li").click(function(e){$(".faq-menu>li").removeClass("active"),$(this).addClass("active")}),$(".modal-inner-link").click(function(e){$to=$(this).attr("data-target"),"#signup"==$to?($($to).modal("toggle"),$("#login").modal("toggle")):($($to).modal("toggle"),$("#signup").modal("toggle"))}),$(".nav-list>h4").click(function(e){$(".nav-list>h4.active").removeClass("active"),$(".nav-contents>div.active").removeClass("active").fadeOut(),$(this).addClass("active"),$to=$(this).attr("data-to"),"rate-card"==$to?$(".nav-contents>div.rate-card").addClass("active").fadeIn():"photos"==$to?$(".nav-contents>div.photos").addClass("active").fadeIn():"reviews"==$to?$(".nav-contents>div.comments").addClass("active").fadeIn():$(".nav-contents>div.professionals").addClass("active").fadeIn()}),$(document).on("hover",".stars>i",function(e){for($data_value=$(this).attr("data-value"),$stars=$(this).parent().find("i"),$i=0;$data_value>0;)$stars.eq($i).addClass("fa-star-hover"),$data_value--,$i++},function(e){$(this).parent().find("i").removeClass("fa-star-hover")}),$(".screen-menu-rate").click(function(e){$(".nav-list>h4").eq(3).click()}),$(document).on("click","#imagebelt",function(e){$(e.currentTarget).empty(),$flag?($(e.currentTarget).append('Show imagery &nbsp;&nbsp;<i class="fa fa-angle-double-up fa-lg" style="color: #fff"></i>'),$("#indicator").slideUp(),$(e.currentTarget).animate({bottom:"15px"}),$flag=!1):($(e.currentTarget).append('Hide imagery &nbsp;&nbsp;<i class="fa fa-angle-double-down fa-lg" style="color: #fff"></i>'),$("#indicator").slideDown(),$(e.currentTarget).animate({bottom:"108px"}),$flag=!0)}),$(document).on({click:function(e){showOverlay(!1),$(".location-suggestion").fadeOut(),$(".categories-list").slideDown(),$(".search-bar").addClass("attop"),e.stopPropagation()},focusin:function(e){showOverlay(!1),$(".location-suggestion").fadeOut(),$(".categories-list").slideDown(),$(".search-bar").addClass("attop"),e.stopPropagation()}},"input[name=service]"),$(document).on({click:function(){showOverlay(!1),$(".search-suggestion").fadeOut(),$(".search-list").slideDown(),$(".search-bar").addClass("attop"),e.stopPropagation()},focusin:function(){showOverlay(!1),$(".search-suggestion").fadeOut(),$(".search-list").slideDown(),$(".search-bar").addClass("attop"),e.stopPropagation()}},"button[name=searchtype]"),$(document).on({focusin:function(){$("html, body").animate({scrollTop:300},500)}},".search-bar:not(.search-bar-top)"),$(document).on("click",".checkbox-btn",function(){$(this).toggleClass("btn-default").toggleClass("btn-primary"),$y=$(this).text(),$z=$(this).find("input[type=hidden]"),("et"==$z.attr("name")||"hl"==$z.attr("name"))&&$z.toggleClass("checked"),"brand"==$z.attr("name")&&($("input[name=brand]").removeClass("checked"),$z.toggleClass("checked"))}),$(document).on("click",".overlay",function(){$(".location-suggestion").fadeOut(),$(".categories-list").fadeOut(),$(".search-list").fadeOut(),$(this).fadeOut(function(){$(".search-bar").removeClass("attop")}),$(".a_dropdown").addClass("hidden")}),$.ajaxSetup({cache:!0}),$.getScript("https://connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"793762427404557",version:"v2.3",cookie:!0,xfbml:!0}),FB.getLoginStatus(function(e){AuthStates.facebook=e,chooseAuthProvider()})})});var categoryParser=function(e){switch(e){case"sp":return"Spa-1";case"sa":return"Salon-2";case"gy":return"Gym-3";case"bp":return"Beauty Parlor-4";case"bph":return"Beauty Parlor at Home-5";case"skc":return"Skin Care-6";case"slc":return"Slimming Center-7";case"pbm":return"Party & Bridal Makeup-8";case"dt":return"Dietician-9";case"ya":return"Yoga & Aerobics-10";case"mp":return"Beauty Parlor-11";case"na":return"Nail Art-12";case"bpp":return"Body Piercing-13";case"md":return"Mehendi-13";case"ot":return"Others-14"}},timeParser=function(e){var o=function(e){return e.substring(1)},t=function(e){return e.substring(0,2)+":"+e.substring(2)};if(e.indexOf("am")>0||e.indexOf("pm")>0){var s=e.split("-")[0],n=e.split("-")[1];return o(t(s))+"-"+o(t(n))}return e};String.prototype.cFL=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$(document).on("click","#dd",function(e){$("#datelist").show(),e.stopPropagation()}),$(document).on("click","#tt",function(e){$("#time").show(),e.stopPropagation()}),$(window).click(function(e){$("#datelist").hide(),$("#time").hide(),$(".categories-list").hide(),$(".location-suggestion").hide(),$("#typeoptions").hide(),$(".popover").hide(),$("#time").hide()}),$(document).on("click","#tooltipreview",function(e){e.preventDefault(),e.stopPropagation()}),$progress=0,$booking={phone:"",storename:"",address:""},$bdatas={},$(document).on("click","#time a",function(e){$booking.time=$(this).html(),$("#tt").val($booking.time),e.preventDefault()}),$(document).on("click","#nextbook",function(){function e(){return $res=!1,$.ajax({data:$bdatas,type:"POST",cache:!1,url:$ROOT_URL+"/sendBookingOtp",xhrFields:{withCredentials:!0},success:function(e){$bdatas.lkey=e,console.log($bdatas),$res=!1},error:function(){console.log("error"),$res=!1}}),$res}function o(){for(var e=$(".cm1"),o="",t=0;t<e.length;t++)o+=""+e.eq(t).val();return 6==o.length?($bdatas.otp=o,!0):!1}if($progress<3){if($progress++,console.log($progress),""==$("#dd").val()||""==$("#tt").val())return alert("Please enter both mobile number and appointment time!"),$progress--,!1;if(2==$progress){if($booking.phone=$("#mn").val(),""==$booking.phone)return $progress--,alert("Please enter a valid phone number!"),!1;$("#mn2").val($booking.phone),$bdatas={storeguid:$qo.storeguid,storeid:$qo.storeID,mobile:$booking.phone,datetime:$booking.date+" - "+$booking.time},console.log($bdatas),e($bdatas)}if(3==$progress){if(this.otpver=!1,!o())return alert("WRONG OTP"),$progress--;console.log($bdatas),$(".header-title>h3").eq(3).html("Please wait, confirming your request.."),$.ajax({data:$bdatas,type:"POST",cache:!1,url:$ROOT_URL+"/sendBookingAck",xhrFields:{withCredentials:!0},beforeSend:function(){$("#booked-storename").html("<center><i class='fa fa-refresh fa-spin fa-2x fa-fw'></i></center>")},success:function(e){"OTPNOTVERIFIED"==e?(alert("WRONG OTP"),$progress--,afterProgress($progress)):($booking.storename=$booking.storename?$booking.storename:$("#storename div:first-child").html(),$booking.address=$booking.address?$booking.address:$("#storeaddress").html(),$("#booked-storename").html($booking.storename),$("#booked-address").html($booking.address),$("#booked-date").html("Date : "+$booking.date),$("#booked-time").html("Time : "+$booking.time),$("#booked-address").find("#gomap").remove(),$("#backbook").hide(),$(".header-title>h3").eq(3).html("Booking Details"),$("#bd").removeClass("hidden"))},error:function(){return alert("WRONG OTP"),$progress--}})}afterProgress($progress)}$("#en").click(function(e){$progress=1,afterProgress($progress)}),$(".cm1").on("keyup",function(){$(this).next().focus()})}),$(document).on("click","#backbook",function(){console.log($progress),$progress>0&&($progress--,afterProgress($progress))}),$(document).on("click","#closebook",function(){$(".header-title h3").hide(),$(".bookcontents").removeClass("showing"),$("#backbook").hide(),$("#footerbtn>div").hide(),$("#footerbtn>div").eq(0).show(),$(".header-title h3").eq(0).show(),$progress=0,$("#bar").animate({width:"25%"})}),$(document).on("click","#closebook2",function(){$(".header-title h3").hide(),$(".bookcontents").removeClass("showing"),$("#backbook").hide(),$("#footerbtn>div").hide(),$("#footerbtn>div").eq(0).show(),$(".header-title h3").eq(0).show(),$progress=0,$("#bar").animate({width:"25%"})}),$("#datelist").click(function(e){e.stopPropagation()}),$(document).on("click",".imask",function(){$(this).remove(),$("#googleMap").css("z-index",1)});
