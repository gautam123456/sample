function resetGlobalVariables(){$qo={blockname:"",blockid:"",blockguid:"",catname:"",catid:"",sortby:"",brandname:"",brandid:1,storename:"",storeID:"",storeguid:"",gender:"",morefilters:"",aminities:[],isFiltered:0,latitude:"",longitude:"",cityname:"",cityid:"",cityguid:"",ratecards:"",storephotos:"",reviews:"",pagesize:10,numberofpages:"",currentpage:1,count:0}}function showOverlay(e){$(".overlay").show(),1==e?$(".circle-outer").show():$(".circle-outer").hide()}function writeallvariables(){}function showFilters(){}function uncheckFilters(){$(".f-menu[name=gender]").prop("checked",!1),$(".f-menu[name=sort]").prop("checked",!1),$(".f-menu[name=more-filters]").prop("checked",!1),$(".weekdays label input[type=checkbox]").prop("checked",!1)}function renderstoreItemView(e){var t=new StoreCollection({isFiltered:$qo.isFiltered});t.fetch({data:$datas,contentType:"application/x-www-form-urlencoded",type:"POST",beforeSend:function(){showOverlay(!0)},dataType:"json",xhrFields:{withCredentials:!0},parse:function(e,t){},success:function(t){var o=t;if(null==o.get("count")||o.get("count")<=0)$(".overlay").fadeOut(),$(".search-result").html("<div class='col-md-12 noresult'><center><h3><i class=\"fa fa-exclamation-triangle\"></i> No Result Found.</h3></center></div>");else{$qo.numberofpages=Math.ceil(o.get("count")/$qo.pagesize);var i=new StoreItemView({stores:o,qo:$qo});i.render(),$(".overlay").fadeOut(),$(".page").removeClass("activepage"),$("#page"+e).addClass("activepage"),1>=e?($("#prev").addClass("hidden"),$("#next").removeClass("hidden")):e>=$qo.numberofpages?($("#next").addClass("hidden"),$("#prev").removeClass("hidden")):($("#next").removeClass("hidden"),$("#prev").removeClass("hidden"))}$(".overlay").fadeOut()},error:function(){$(".overlay").fadeOut(),$(".search-result").html("<div class='col-md-12 noresult'><center><h3><i class=\"fa fa-exclamation-triangle\"></i> No Result Found.</h3></center></div>")}})}function getRateCard(e){var t;return $.ajax({url:$ROOT_URL+"/getratecard",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:e,dataType:"json",parse:function(e,t){},success:function(e){t=e},error:function(e){console.log("Error "+JSON.stringify(e))}}),t}function getStorePhoto(e){var t;return $.ajax({url:$ROOT_URL+"/getstorephotos",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:e,dataType:"json",parse:function(e,t){},success:function(e){t=e},error:function(e){console.log("Error "+JSON.stringify(e))}}),t}function getStoreReview(e){var t;return $.ajax({url:$ROOT_URL+"/getReviewForStore",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:{storeguid:$qo.storeguid,storeid:$qo.storeID,lkey:""},dataType:"json",parse:function(e,t){},success:function(e){t=e},error:function(e){console.log("Error "+JSON.stringify(e))}}),t}function getStoreTrust(e){var t;return $.ajax({url:$ROOT_URL+"/getstoredetails",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:{guid:$qo.storeguid,storeid:$qo.storeID},dataType:"json",parse:function(e,t){},success:function(e){t=e},error:function(e){console.log("Error"+JSON.stringify(e))}}),t}function saveReview(e,t){return $.ajax({url:$ROOT_URL+"/saveReview",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:e,xhrFields:{withCredentials:!0},dataType:"text",parse:function(e,t){},success:function(o){if(e=o,$("#reviewerror").empty(),$("#rateerror").empty(),1==t){$("#reviewerror").append('<center><div class="successmsg col-md-12">ThankYou !! Review submitted successfully</div></center>');var i=new ReviewsView({reviews:getStoreReview($datas)});$("#store-reviews").append(i.render())}else $("#rateerror").append('<center><div class="successmsg col-md-12">ThankYou !! Rating submitted successfully</div></center>')},error:function(e){401!=e.status?$("#reviewerror").empty().append('<center><div class="errormsg col-md-12">Oh !! something went wrong, we can\'t take reviews for some time</div></center>'):$("#reviewerror").empty().append('<center><div class="errormsg col-md-12">You need to log in first!</div>')}})}function saveFavourite(e){return $.ajax({url:$ROOT_URL+"/saveBookmark",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,xhrFields:{withCredentials:!0},dataType:"text",parse:function(e,t){},success:function(t){e=t},error:function(e){console.log("------------Error in favourite save------------")}})}function deleteFavourite(e){return $.ajax({url:$ROOT_URL+"/deleteBookmark",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,xhrFields:{withCredentials:!0},dataType:"text",parse:function(e,t){},success:function(t){e=t},error:function(e){console.log("------------Error in favourite save------------")}})}function saveCheckin(e){return $.ajax({url:$ROOT_URL+"/saveCheckin",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,xhrFields:{withCredentials:!0},dataType:"text",parse:function(e,t){},success:function(t){e=t},error:function(e){console.log("------------Error in Chekin save------------")}})}function deleteCheckin(e){return $.ajax({url:$ROOT_URL+"/deleteCheckin",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,xhrFields:{withCredentials:!0},dataType:"text",parse:function(e,t){},success:function(t){e=t},error:function(e){console.log("------------Error in Chekin save------------")}})}function getLocationSuggestion(e){return e=escape(e),$.ajax({type:"POST",url:$ROOT_URL+"/getLocation",cache:!1,data:"location="+e,dataType:"json",xhrFields:{withCredentials:!0},beforeSend:function(){$(".search-bar-spinner").css("display","inline-block")},success:function(e,t,o){$(".search-bar-spinner").fadeOut(),$location_suggestion="",e.length>0?($.each(e,function(e,t){$location_suggestion+='<div class="list-group-item location-item" style="" data-l-guid="'+t.id+"-"+t.guid+'"><i class="fa mm marker fa-lg no-text-indent"></i><span class="locationlabel">'+t.locationName+"</span></div>"}),$(".location-suggestion").html($location_suggestion).slideDown()):($(".location-suggestion").html('<div class="list-group-item text-danger" >No suggesstions found.</div>').slideDown(),$(".search-bar-spinner").fadeOut())}}).fail(function(){$(".location-suggestion").html('<div class="list-group-item text-danger" >No suggesstions found.</div>').slideDown(),$(".search-bar-spinner").fadeOut(),console.log("failed")})}function getStoreSuggestion(e,t){return e=escape(e),$.ajax({type:"POST",url:$ROOT_URL+"/searchStoreLite",cache:!1,data:"storehint="+e,dataType:"json",xhrFields:{withCredentials:!0},beforeSend:function(){$(".search-bar-spinner2").css("display","inline-block")},success:function(e,t,o){return $(".search-bar-spinner").fadeOut(),$location_suggestion="",$address="",e.length>0?($.each(e,function(e,t){$address=t.address.split(","),t.count>0?$location_suggestion+='<div class="list-group-item brand-item store1" value="'+t.storename+'" data-l-guid="'+t.brandID+'"><i class="fa marker store ms fa-lg "></i><span class="margin-left-5" style=\'font-weight: bolder\'> '+t.storename+"  &nbsp;</span><span style='font-size: 10px;border: 1px solid #f2f2f2;padding: 3px 5px;border-radius: 2px'>"+t.count+" &nbsp;Branches</span></div>":$location_suggestion+='<div class="list-group-item store-item store1" data-l-guid="'+t.id+"-"+t.guid+'"><i class="fa marker store ms fa-lg "></i><span class="margin-left-5" style=\'font-weight: bolder\'> '+t.storename+" , &nbsp;</span><span style='font-size: 10px'>"+$address[$address.length-2]+" , "+$address[$address.length-1]+"</span></div>"}),$(".location-suggestion").html($location_suggestion).slideDown()):($(".location-suggestion").html('<div class="list-group-item text-danger">No suggesstions found.</div>').slideDown(),$(".search-bar-spinner").fadeOut()),e}}).fail(function(){$(".location-suggestion").html('<div class="list-group-item text-danger" >No suggesstions found.</div>').slideDown(),$(".search-bar-spinner").fadeOut(),console.log("failed")})}function logoutFromServer(){return $.ajax({type:"GET",url:$ROOT_URL+"/custlogout",dataType:"text",xhrFields:{withCredentials:!0},success:function(e){console.log("Logout"+JSON.stringify(e)),location.reload()}}).fail(function(){console.log("failed")})}function template_loader(e,t,o,i){$.ajax({url:e,type:"GET",dataType:"text",beforeSend:function(){showOverlay(!0);var e=new HeaderSearchBar;e.render()},success:function(e){$temp="<script type='text/template' id='"+t+"'>"+e+"</script>",$("body").append($temp);var i=_.template(e)({data:""});return $(".main-container-top").html(i),$(".overlay").fadeOut(),$("html, body").animate({scrollTop:0},1e3),void 0!=o&&this.postrender(),!0},postrender:function(){$(document).find(o).append($(document).find(i).html())}})}function renderTemplate(e,t){$.ajax({url:" /templates/"+e+".html",type:"GET",processData:!1,success:function(o){$("body").append(o),new UserProfileInfo({template:e,data:t}).render()}}).fail(function(e){console.log(e)})}function getCustomerInfo(e,t){var o;return $.ajax({url:$ROOT_URL+"/"+e,type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:t,dataType:"json",xhrFields:{withCredentials:!0},success:function(e){o=e},error:function(e){console.log(JSON.stringify(e))}}),o}function getSponsoredStores(e,t){e.fetch({data:$datas,dataType:"json",type:"POST",beforeSend:function(){showOverlay(!0)},success:function(e){$(".overlay").fadeOut();var o=new SponsoredStoreListView({sponsoredStores:e,qo:$qo,el:".search-result"+t});o.render(),$qo.count=e.get("count"),$qo.count/9>t?$(".loadmore").removeClass("hidden"):$(".loadmore").addClass("hidden")},error:function(e,t){console.log("Error : "+t.responseText+t+JSON.stringify(t)),$(".overlay").fadeOut()}})}$qo={},$fixed=!1,$rate=0,$searchby=1;var timeoutId=!1;$booking={servicetype:"",date:"",time:"",name:"",number:"",otp:"",lkey:"",storename:"",storeaddress:""},resetGlobalVariables(),$("#nbooking").click(function(e){switch(value=parseInt($(e.currentTarget).val()),console.log("value-------------"+value),value){case 1:console.log("inside case 1 ---------------------------------------"),$booking.date=$("#datepickerr").val(),$booking.time=$("#time").val(),""==$booking.date||""==$booking.time?(console.log("inside case 1 -----------if----------------------------"),$("#otpmsg").removeClass("hidden")):(console.log("inside case 1 -----------else----------------------------"),$("#otpmsg").addClass("hidden"),(new OTPDetails).render(),$(e.currentTarget).val(parseInt(value)+1),$(".num"+(parseInt(value)+1)).removeClass("inactivestep").addClass("activestep"));break;case 2:$booking.number=$("#mobile").val(),10!=$booking.number.length?($("#otpmsg").addClass("hidden"),$("#mobilemsg").removeClass("hidden")):($datas={storeguid:$qo.storeguid,storeid:$qo.storeID,mobile:$booking.number,offer:"25",datetime:$booking.date+" - "+$booking.time},$.ajax({url:$ROOT_URL+"/sendBookingOtp",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:$datas,xhrFields:{withCredentials:!0},dataType:"text",success:function(t){$booking.lkey=t,$(e.currentTarget).val(parseInt(value)+1),$(".num"+(parseInt(value)+1)).removeClass("inactivestep").addClass("activestep"),$("#otpmsg").addClass("hidden"),(new OTPConfirm).render(),$("#nbooking").empty().append("<span>Submit</span>")},error:function(e){$("#otpmsg").text("Something went wrong no OTP generated").removeClass("hidden")}}));break;case 3:$("#otpmsg").addClass("hidden"),$("#mobilemsg").addClass("hidden"),$booking.otp=$("#otpp").val(),6!=$booking.otp.length?$("#otperror").removeClass("hidden"):($datas={storeguid:$qo.storeguid,storeid:$qo.storeID,mobile:$booking.number,otp:$booking.otp,lkey:$booking.lkey},$.ajax({url:$ROOT_URL+"/sendBookingAck",type:"POST",async:!1,contentType:"application/x-www-form-urlencoded",data:$datas,dataType:"text",xhrFields:{withCredentials:!0},success:function(t){"OTPVERIFIED"==t.toString().toUpperCase()?(new OTPSuccess({booking:$booking}).render(),$(e.currentTarget).val(parseInt(value)+1),$(".num"+(parseInt(value)+1)).removeClass("inactivestep").addClass("activestep"),$("#otperror").addClass("hidden"),$("#otpmsg").addClass("hidden"),$("#nbooking").empty().append("<span>Close</span>"),$("#cbooking").empty().append("<span>Book again</span>")):$("#otpmsg").text("Wrong OTP enetered, please provide correct OTP").removeClass("hidden")},error:function(e){$("#otpmsg").text("Something went wrong,please provide correct OTP").removeClass("hidden")}}));break;case 4:$("#otp").modal("toggle"),$("#cbooking").empty().append("<span>Book again</span>");break;default:$("#otp").modal("toggle"),$("#cbooking").empty().append("<span>Book again</span>")}}),$("#cbooking").click(function(e){$(".num1").removeClass("inactivestep").addClass("activestep"),$(".num2").removeClass("activestep").addClass("inactivestep"),$(".num3").removeClass("activestep").addClass("inactivestep"),$(".num4").removeClass("activestep").addClass("inactivestep"),$("#nbooking").val(1),$("#nbooking").empty().append("<span>Next</span>"),$booking.date="",$booking.otp="",$booking.time="",$booking.number="",$booking.servicetype="",$booking.lkey="",(new OTPSlot).render(),$("#cbooking").empty().append("<span>Clear</span>"),$("#otpmsg").addClass("hidden"),$("#datepickerr").click(),$("#pickslot").click()}),$(document).on("click",".location-item",function(e){$qo.blockname=$(this).text(),$qo.blockguid=$(this).attr("data-l-guid").split("-")[1],$qo.blockid=$(this).attr("data-l-guid").split("-")[0],$(document).find("input[name=location]").val($qo.blockname).attr("data-val",$qo.blockid+"-"+$qo.blockguid),$(document).find("input[name=service]").click(),$(".location-list").slideUp(),e.stopPropagation()}),$(document).on("click",".categories-list>.list-group-item",function(e){$(".location-list").slideUp(),$qo.catname=$(this).text(),$qo.catid=$(this).attr("data-catid"),$(document).find("input[name=service]").val($qo.catname).attr("data-val",$qo.catid),$(".categories-list").slideUp(),$(".search-list").slideUp(),e.stopPropagation()}),$(document).on("click",".search-bar>a",function(e){e.preventDefault(),""!=$qo.blockguid&&""!=$qo.catid?($(".search-bar").removeClass("attop"),router.navigate("#/stores/"+$qo.blockname+"-"+$qo.blockid+"-"+$qo.blockguid+"-"+$qo.catname+"-"+$qo.catid+"-1",{trigger:!0})):""==$qo.blockguid&&1==$searchby?$(".location-suggestion").html('<div class="list-group-item text-danger" >please select a location</div>').slideDown():$(".location-suggestion").html("<div class=\"list-group-item text-danger\" style='width: 970px'>please select store, brand</div>").slideDown()}),$(document).on("click",".search-bar>div>div .list-group-item.service",function(e){e.preventDefault(),$qo.isFiltered=0,""!=$qo.blockguid&&""!=$qo.catid?($(".search-bar").removeClass("attop"),router.navigate("#/stores/"+$qo.blockname+"-"+$qo.blockid+"-"+$qo.blockguid+"-"+$qo.catname+"-"+$qo.catid+"-1",{trigger:!0})):(""==$qo.blockguid&&1==$searchby&&$(".location-suggestion").html('<div class="list-group-item text-danger" >please select a location</div>').slideDown(),console.log("error"))});var storesSet=Backbone.Model,defModel=Backbone.Model,StoreCollection=Backbone.Model.extend({initialize:function(e){this.options=e},url:function(){return 1==this.options.isFiltered?$ROOT_URL+"/geftstores":$ROOT_URL+"/getstores"},parse:function(e){return e}}),SponsoredCollection=Backbone.Model.extend({initialize:function(e){this.options=e},url:function(){return $ROOT_URL+"/getsponsoredlistforAdvertisement"},parse:function(e){return e}}),BrandStoreCollection=Backbone.Model.extend({initialize:function(e){this.options=e},url:function(){return $ROOT_URL+"/getStoresForBrand"},parse:function(e){return e}}),ProfileView=Backbone.View.extend({el:".main-container-top",events:{"click .user-profile-menu>label":"show_details"},initialize:function(){resetGlobalVariables()},render:function(){var e,t=this;$("#user-profile-template").length>0?(e=_.template($("#user-profile-template").html()),t.$el.html(e).trigger("create")):$.ajax({url:" /templates/userprofile.html",type:"GET",processData:!1,async:"false",success:function(o){$("body").append(o),e=_.template($(document).find("#user-profile-template").html()),t.$el.html(e).trigger("create"),$(document).scrollTop(),console.log("hello")}}).fail(function(e){console.log(e)})},show_details:function(e){$(".overlay").fadeIn();var t,o={lkey:""};switch($(e.currentTarget).attr("id")){case"user-menu-profile":renderTemplate("user-profile-info",t);break;case"user-menu-lookplex-journey":t=getCustomerInfo("getCustomerTimeline",o),renderTemplate("user-journey",t);break;case"user-menu-bookmarks":t=getCustomerInfo("getCustomerBookmark",o),renderTemplate("user-bookmarks",t);break;case"user-menu-ratings":t=getCustomerInfo("getCustomerRecommend",o),renderTemplate("user-bookmarks",t);break;case"user-menu-reviews":t=getCustomerInfo("getCustomerReview",o),renderTemplate("user-reviews",t);break;case"user-menu-checkins":t=getCustomerInfo("getCustomerCheckin",o),renderTemplate("user-profile-info",t)}$(".overlay").fadeOut()}}),UserProfileInfo=Backbone.View.extend({el:".profile-content",initialize:function(e){this.options=e},render:function(){var e=_.template($("#"+this.options.template).html()),t=e({data:this.options.data});this.$el.html(t).trigger("create")}}),HomeView=Backbone.View.extend({el:".main-container-top",events:{"mouseenter .buzzworthy":"expand","mouseleave .buzzworthy":"shrink","click #location":"location","click #storename":"storename","click .store-item":"storeselect","click .brand-item":"brandselect","focusin input[name=location]":"searchfocus","keyup input[name=location]":"keyup","click input[name=service]":"settabindex","keyup input[name=service]":"keyupservice"},initialize:function(){resetGlobalVariables(),_.bindAll(this,"detect_scroll"),$(window).scroll(this.detect_scroll),this.suggestionTimeout=null,this.queryOld="hello"},settabindex:function(e){this.tabindex=-1},keyupservice:function(e){switch(e.which){case 40:$(".service").removeClass("hovered"),this.tabindex<10?this.tabindex+=1:this.tabindex=0,$(".service:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex);break;case 38:$(".service").removeClass("hovered"),this.tabindex>0?this.tabindex-=1:this.tabindex=10,$(".service:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex);break;case 37:break;case 39:break;case 13:this.tabindex>-1&&($(".service:eq("+this.tabindex+")").click(),this.tabindex=0)}},render:function(){var e,t=this;this.sponsorList||$.getJSON("/data/sponsors.json?v=1.0",function(o){t.sponsorList=o,$("#home-template").length>0?(e=_.template($("#home-template").html()),t.$el.html(e({sponsors:t.sponsorList})).trigger("create")):$.ajax({url:" /templates/homepage.html",type:"GET",processData:!1,success:function(o){$("body").append(o),e=_.template($(document).find("#home-template").html()),t.$el.html(e({sponsors:t.sponsorList})).trigger("create"),$(".page-header").removeClass("gray-bg")}}).fail(function(e){console.log(e)})}),2==$searchby&&$("#storename").click()},expand:function(e){},shrink:function(e){},detect_scroll:function(){scroll=$(window).scrollTop(),scroll>=350&&scroll<=450&&$(".close").click()},location:function(){$searchby=1,$(".list-group.location-suggestion").empty(),$("input[name=location]").val(""),$("input[name=location]").attr("placeholder","Enter area, landmark, colony"),$("input[name=location]").parent().animate({width:511},0),$("input[name=service]").parent().css("display","inline-block"),$(".marker").removeClass("store"),$("#location").blur()},storename:function(){$searchby=2,$(".list-group.location-suggestion").empty(),$(".list-group.categories-list").css("display","none"),$(".list-group.search-list").css("display","none"),$("input[name=location]").val(""),$("input[name=location]").attr("placeholder","Enter store name, brand name"),$("input[name=location]").parent().animate({width:840},0),$("input[name=service]").parent().css("display","none"),$(".marker").addClass("store"),$("#storename").blur()},storeselect:function(e){showOverlay(!0),$(".search-bar").removeClass("attop"),$(".slider-min-content-new2").removeClass("attop"),$(".list-group.location-suggestion").empty(),router.navigate("#/stores/profile/"+$(e.currentTarget).attr("data-l-guid"))},brandselect:function(e){showOverlay(!0),$(".search-bar").removeClass("attop"),$(".slider-min-content-new2").removeClass("attop"),$(".list-group.location-suggestion").empty(),router.navigate("#/brands/profile/"+$(e.currentTarget).attr("data-l-guid")+"-"+$(e.currentTarget).attr("value").split(" ").join("_")+"-1")},searchfocus:function(){showOverlay(!1),$(".categories-list").slideUp(),$(".search-list").css("display","none"),$(".how-it-works").slideUp(),$queryNew=$("input[name=location]").val(),$(".search-bar").addClass("attop"),$(".slider-min-content-new2").addClass("attop")},keyup:function(e){switch(e.which){case 40:e.preventDefault(),2==$searchby?($(".store-item.store1").removeClass("hovered"),this.tabindex<this.stores.length-1?this.tabindex+=1:this.tabindex=0,$(".store-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex)):($(".location-item").removeClass("hovered"),console.log(this.locations.length),this.tabindex<this.locations.length-1?this.tabindex+=1:this.tabindex=0,$(".location-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex));break;case 38:e.preventDefault(),2==$searchby?($(".store-item.store1").removeClass("hovered"),this.tabindex>0?this.tabindex-=1:this.tabindex=this.stores.length-1,$(".store-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex)):($(".location-item").removeClass("hovered"),console.log(this.locations.length),this.tabindex>0?this.tabindex-=1:this.tabindex=this.locations.length-1,$(".location-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex));break;case 37:break;case 39:break;case 9:break;case 13:this.tabindex>-1&&(2==$searchby?$(".store-item.store1:eq("+this.tabindex+")").click():($(".location-item:eq("+this.tabindex+")").click(),this.tabindex=-1,$("input[name=service]").click(),$("input[name=service]").focus()));break;default:console.log(e.which);var t=this;this.suggestionTimeout=this.suggestionTimeout||null,$queryNew=$("input[name=location]").val(),this.suggestionTimeout&&clearTimeout(this.suggestionTimeout),console.log("old",this.queryOld),console.log("new ",$queryNew),this.suggestionTimeout=setTimeout(function(){$queryNew!=this.queryOld&&$queryNew.length>2?(this.queryOld=$queryNew,2==$searchby?getStoreSuggestion($queryNew,970).success(function(e){t.stores=e,t.tabindex=-1}):getLocationSuggestion($queryNew).success(function(e){t.locations=e,t.tabindex=-1})):$(".location-suggestion").fadeOut()},500)}}}),HomeViewBottom=Backbone.View.extend({el:".main-container-bottom",initialize:function(){},render:function(){var e,t=this;$("#home-bot-template").length>0?(e=_.template($("#home-bot-template").html()),t.$el.html(e).trigger("create")):$.ajax({url:" /templates/homepagebot.html?v=1.1",type:"GET",processData:!1,success:function(o){$("body").append(o),e=_.template($(document).find("#home-bot-template").html()),t.$el.html(e).trigger("create")}}).fail(function(e){console.log(e)})}}),HomeViewMidRibbon=Backbone.View.extend({el:".full-width-container",initialize:function(){},render:function(){var e,t=this;$("#home-ribbon").length>0?(e=_.template($("#home-ribbon").html()),t.$el.html(e).trigger("create")):$.ajax({url:" /templates/home-mid.html",type:"GET",processData:!1,success:function(o){$("body").append(o),e=_.template($(document).find("#home-ribbon").html()),t.$el.html(e).trigger("create")}}).fail(function(e){console.log(e)})}}),LoginView=Backbone.View.extend({el:".top-menu>a:last",render:function(){var e=_.template($("#logint").html()),t=e();this.$el.html(t).trigger("create"),$(".top-menu>a:last").attr("data-target","#login")}}),TopAccMenu=Backbone.View.extend({el:".top-menu>a:last",events:{"click #logout0":"logout","click #profile0":"profile"},show_menu:function(){$(".top-menu>a:last>ul").toggleClass("hidden")},hide_menu:function(){$(".top-menu>a:last>ul").toggleClass("hidden")},logout:function(e){(new LoginView).render(),"facebook"==$user.platform?FB.logout(function(){logoutFromServer().success(function(){clearUser(),render_umenu()})}):(console.log(gapi.auth),$.ajax({type:"GET",url:"https://accounts.google.com/o/oauth2/revoke?token="+gapi.auth.getToken().access_token,async:!1,contentType:"application/json",dataType:"jsonp",success:function(e){logoutFromServer().success(function(){clearUser(),render_umenu()})},error:function(e){console.log(e)}})),e.stopPropagation()},profile:function(e){e.preventDefault(),router.navigate("/profile")},render:function(){var e=_.template($("#p_img").html()),t=e({i:$user.image,j:$user.displayName});this.$el.html(t).trigger("create"),$(".top-menu>a:last").attr("data-target","#logout")}}),HeaderSearchBar=Backbone.View.extend({el:".page-header",events:{"focus input[name=location]":"aa","click .search-list-group-item":"selectsearchtype","click .store1":"storeselect","click .brand-item":"brandselect","keyup input[name=location]":"searching","focus input[name=location]":"searchfocus","click #searchit":"showsearchoptions","click #servicesearch":"settabindex","keyup input[name=service]":"keyupservice"},aa:function(){},settabindex:function(){this.tabindex=-1,$("#categories-list").slideDown()},keyupservice:function(e){switch(e.which){case 40:$(".service").removeClass("hovered"),this.tabindex<9?this.tabindex+=1:this.tabindex=0,$(".service:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex);break;case 38:$(".service").removeClass("hovered"),this.tabindex>0?this.tabindex-=1:this.tabindex=9,$(".service:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex);break;case 37:break;case 39:break;case 13:this.tabindex>-1&&($qo.isFiltered=0,$(".service:eq("+this.tabindex+")").click(),this.tabindex=0)}},render:function(){var e=_.template($("#header-search-bar").html()),t=e();this.$el.html(t).trigger("create"),$(".page-header").addClass("gray-bg"),render_umenu(),2==$searchby&&$("#storename2").click()},brandselect:function(e){showOverlay(!0),$(".search-bar").removeClass("attop"),$(".slider-min-content-new2").removeClass("attop"),$(".list-group.location-suggestion").empty(),router.navigate("#/brands/profile/"+$(e.currentTarget).attr("data-l-guid")+"-"+$(e.currentTarget).attr("value").split(" ").join("_")+"-1")},selectsearchtype:function(e){e.stopPropagation(),showOverlay(!1),$("input[name=location]").val(""),$searchby=$(e.currentTarget).attr("value"),$("label[id=searchtype]").text($(e.currentTarget).text()),$(".search-list").css("display","none"),$(".categories-list").css("display","none"),$(".location-suggestion").css("display","none"),2==$searchby?($("input[name=location]").attr("placeholder","Search by store name, brand name"),$("input[name=location]").parent().animate({width:554,marginRight:"1.5px"},0),$("input[name=service]").parent().hide(),$(".marker").addClass("store")):($("input[name=location]").attr("placeholder","Search by city, landmark, colony"),$("input[name=location]").parent().animate({width:340},0),$("input[name=service]").parent().show(),$(".marker").removeClass("store"))},storeselect:function(e){showOverlay(!0),router.navigate("#/stores/profile/"+$(e.currentTarget).attr("data-l-guid"),!0)},searching:function(e){var t=this;switch(e.which){case 40:e.preventDefault(),2==$searchby?($(".store-item.store1").removeClass("hovered"),this.tabindex>this.stores.length-1&&(this.tabindex=0),$(".store-item:eq("+this.tabindex+")").toggleClass("hovered"),this.tabindex++,console.log(this.tabindex+"---------------------22")):($(".location-item").removeClass("hovered"),console.log(this.locations.length),this.tabindex>this.locations.length-1&&(this.tabindex=0),$(".location-item:eq("+this.tabindex+")").toggleClass("hovered"),this.tabindex++,console.log(this.tabindex+"--------------------33"));break;case 38:e.preventDefault(),2==$searchby?($(".store-item.store1").removeClass("hovered"),this.tabindex>0?this.tabindex-=1:this.tabindex=this.stores.length-1,$(".store-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex+"-------------------------44")):($(".location-item").removeClass("hovered"),console.log(this.locations.length),this.tabindex>0?this.tabindex-=1:this.tabindex=this.locations.length-1,$(".location-item:eq("+this.tabindex+")").toggleClass("hovered"),console.log(this.tabindex+"-------------------------55"));break;case 37:break;case 39:break;case 13:this.tabindex>-1&&(2==$searchby?($(".store-item.store1:eq("+this.tabindex+")").click(),this.tabindex=0):($(".location-item:eq("+this.tabindex+")").click(),this.tabindex=0),$("input[name=service]").click(),$("input[name=service]").focus(),console.log(this.tabindex));break;default:this.suggestionTimeout=this.suggestionTimeout||null,this.queryOld=this.queryOld||"",$queryNew=$("input[name=location]").val(),this.suggestionTimeout&&clearTimeout(this.suggestionTimeout),this.suggestionTimeout=setTimeout(function(){$queryNew!=this.queryOld&&$queryNew.length>2?2==$searchby?getStoreSuggestion($queryNew,970).success(function(e){t.stores=e,t.tabindex=0}):getLocationSuggestion($queryNew).success(function(e){t.locations=e,t.tabindex=0}):$(".location-suggestion").fadeOut()},500)}},searchfocus:function(e){showOverlay(!1),$(".search-bar").addClass("attop")},showsearchoptions:function(e){showOverlay(!1),$("#typeoptions").css("display","block"),e.stopPropagation()}}),HowItWorks=Backbone.View.extend({el:"#hiwdiv",render:function(){var e=_.template($("#hiw").html()),t=e();this.$el.html(t).trigger("create")}}),Share=Backbone.View.extend({el:"#ishare",initialize:function(){_.bindAll(this,"detect_scroll"),$(window).scroll(this.detect_scroll),this.status=0},events:{"click #shareit":"expandorshrink"},render:function(){var e=_.template($("#share-template").html()),t=e();this.$el.html(t).trigger("create")},expandorshrink:function(){0==this.status?(this.expand(),this.status=1,console.log("hula1")):1==this.status&&(this.shrink(),this.status=0,console.log("hula0"))},expand:function(){$("#ishared").animate({height:400,bottom:70},1e3),$flag=!0},shrink:function(){$("#ishared").animate({height:55,bottom:200},2e3),$flag=!1},detect_scroll:function(){$flag&&$("#ishared").animate({height:55,bottom:200},1e3),$flag=!1}}),HeaderNoSearchBar=Backbone.View.extend({el:".page-header",render:function(){var e=_.template($("#header-no-search-bar").html()),t=e();this.$el.html(t).trigger("create"),$(".page-header").removeClass("gray-bg"),render_umenu()}}),AboutView=Backbone.View.extend({el:".main-container",initialize:function(e){this.options=e},render:function(){var e=_.template($("#about").html());this.$el.html(e)}}),SearchView=Backbone.View.extend({el:".main-container-top",events:{"click .fi-menu":"filter","click .f-menu":"brandupdate","click .page":"pagewise","focusin #brandsearch":"brandsearch","click .showdays>u":"weekdaystoggle","click #clearfilter":"clearfilter"},initialize:function(e){_.bindAll(this,"detect_scroll"),$(window).scroll(this.detect_scroll),this.options=e},render:function(){var e=new HeaderSearchBar;e.render();var t=_.template($("#searchtemplate").html()),o=t({aid:this.options.aid,bid:this.options.bid,cid:this.options.cid,did:this.options.did});return this.$el.html(o).trigger("create"),renderstoreItemView(1),$.ajax({url:$ROOT_URL+"/getbrandaminityList",type:"POST",contentType:"application/x-www-form-urlencoded",data:{catid:$qo.catid},dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,parse:function(e,t){},success:function(e){$.each(e.brandlist,function(e,t){$(".sub-filter:eq(4)").append('<label class=\'tocontinue\'><input class=" fi-menu brandname" type="checkbox" multiple name="brand[]" value="'+t.id+'">'+t.brandName+"</label>")}),showFilters()},error:function(e){console.log(JSON.stringify(e))}}),$(".weekdays").slideUp(),this},weekdaystoggle:function(e){"edit"==$(e.currentTarget).text()?($(".weekdays").slideDown(500),$(e.currentTarget).text("hide")):($(".weekdays").slideUp(500),
    $(e.currentTarget).text("edit"))},detect_scroll:function(){scroll=$(window).scrollTop(),scroll>=90&&scroll<800&&!$fixed?($(".parlor-screen2").addClass("fixed").addClass("psposition"),$fixed=!0):scroll<90&&$fixed?($(".parlor-screen2").removeClass("fixed").removeClass("psposition"),$fixed=!1):scroll>800&&$fixed&&($fixed=!1)},filter:function(e){e.stopPropagation(),$(this.el).off("click",".input[name=etype0]"),$qo.currentpage=1,$qo.aminities=[],$qo.brandname=$(".brandname:checked").map(function(){return this.value}).get().join(","),$qo.gender=$("input[name=gender]:checked").val(),void 0==$qo.brandname&&($qo.brandName=null),void 0==$qo.gender?$qo.gender=null:$qo.aminities.push($qo.gender),$qo.catid=$("input[name=etype0]:checked").val().split("-")[1],2==$qo.catid?$qo.catid="2,4,5":7==$qo.catid?$qo.catid="6,7":14==$qo.catid&&($qo.catid="12,14"),$qo.sortby=$("input[name=sort]:checked").val(),"undefined"==typeof $qo.sortby&&($qo.sortby="none"),$qo.morefilters=$(".more-filters:checked").map(function(){return this.value}).get().join(","),void 0==$qo.morefilters||""==$qo.morefilters?$qo.morefilters=null:$qo.aminities.push($qo.morefilters),$aminities=$qo.aminities.join(","),$qo.isFiltered=1,$datas={blockid:$qo.blockid,blockguid:$qo.blockguid,aminities:$aminities,brandname:$qo.brandname,catid:$qo.catid,startindex:1,endindex:$qo.pagesize,sortby:$qo.sortby},renderstoreItemView($qo.currentpage),$("html, body").animate({scrollTop:90},500),$("input").blur()},brandupdate:function(e){e.preventDefault(),e.stopPropagation();var t=$("input[name=etype0]:checked").val();$qo.isFiltered=0;var o=window.location.href.split("-");o.splice(o.length-3,3),window.location=o.join("-")+"-"+t+"-1"},pagewise:function(e){showOverlay(!0),$qo.isFiltered=1;var t=$(e.target);"prev"==t.attr("id")?$qo.currentpage=parseInt($(".activepage").attr("data-value"))-1:"next"==t.attr("id")?$qo.currentpage=parseInt($(".activepage").attr("data-value"))+1:$qo.currentpage=parseInt(t.attr("data-value"));var o=($qo.currentpage-1)*$qo.pagesize+1;$aminities=$qo.aminities.join(","),$datas={blockid:$qo.blockid,blockguid:$qo.blockguid,catid:$qo.catid,brandname:$qo.brandname,aminities:$aminities,startindex:o,endindex:o+$qo.pagesize,sortby:$qo.sortby},renderstoreItemView($qo.currentpage),$("html, body").animate({scrollTop:90},500)},brandsearch:function(){$queryNew=$("#brandsearch").val(),$("#brandsearch").on("keyup",function(e){$(".tocontinue").removeClass("hidden"),$queryNew=$("#brandsearch").val(),$queryNew.length>2?$(".tocontinue").each(function(){$(this).text().toString().toLowerCase().search($queryNew.toString().toLowerCase())>-1||$(this).addClass("hidden")}):$(".tocontinue").removeClass("hidden")})},clearfilter:function(){window.location.reload()}}),StoreItemView=Backbone.View.extend({el:".search-result",initialize:function(e){this.options=e},events:{"click #sharestorelist":"expand","click #ratecarddrop":"ratecarddrop","click #photodrop":"photodrop","click #reviewdrop":"reviewdrop","click #trustdrop":"trustdrop","click #booknowp2":"booknowp2"},render:function(){var e=_.template($("#result-item-template").html()),t=e({stores:this.options.stores,qo:this.options.qo});this.$el.html(t).trigger("create"),$('[data-toggle="popover"]').popover()},expand:function(e){$(e.currentTarget).animate({width:194},500)},shrink:function(e){$(e.currentTarget).animate({width:35},1e3)},ratecarddrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new RateCardView({ratecards:getRateCard($datas),el:"#rate-"+$qo.storeID});$("#rate-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},booknowp2:function(e){$qo.storeID=$(e.currentTarget).data("storeid"),$qo.storeguid=$(e.currentTarget).data("storeguid"),$booking.storename=$(e.currentTarget).data("storename"),$booking.address=$(e.currentTarget).data("address");var t=new StoreProfile;t.booking()},photodrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new StorePhotoView({storephotos:getStorePhoto($datas),el:"#photo-"+$qo.storeID});$("#photo-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},reviewdrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new ReviewsView({reviews:getStoreReview($datas),el:"#review-"+$qo.storeID});$("#review-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},trustdrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new TrustsView({data:getStoreTrust($datas),el:"#trust-"+$qo.storeID});$("#trust-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},getKeys:function(e){return $(e.currentTarget).parent()}}),BrandView=Backbone.View.extend({el:".main-container-top",initialize:function(e){this.options=e},events:{"click .loadmore":"loadmore"},render:function(){var e=new HeaderSearchBar;e.render();var t=_.template($("#brand-stores").html()),o=t({qo:this.options.qo});this.$el.html(o).trigger("create")},loadmore:function(){if($qo.count>9*$qo.currentpage){$datas={brandid:$qo.brandid,startindex:9*$qo.currentpage+1,endindex:9*($qo.currentpage+1)};var e=new BrandStoreCollection;getSponsoredStores(e,$qo.currentpage+1)}else $(".loadmore").addClass("hidden");$qo.currentpage=$qo.currentpage+1}}),SponsoredStoreView=Backbone.View.extend({el:".main-container-top",initialize:function(e){this.options=e},events:{"click .f-menu":"cityselect"},render:function(){var e=new HeaderSearchBar;e.render();var t=_.template($("#services-collection").html()),o=t({qo:this.options.qo});this.$el.html(o).trigger("create")},cityselect:function(e){$(this.el).off("click",".f-menu");var t=$("input[name=etype0]:checked").val();router.navigate("#/stores/services/"+t+"-"+$qo.catname+"-"+$qo.cid+"-1",!0),e.stopPropagation()}}),SponsoredCityStoreView=Backbone.View.extend({el:".main-container-top",initialize:function(e){this.options=e},events:{"click .f-menu":"serviceselect"},render:function(){var e=new HeaderSearchBar;e.render();var t=_.template($("#cities-collection").html()),o=t({qo:this.options.qo});this.$el.html(o).trigger("create")},serviceselect:function(e){$(this.el).off("click",".f-menu");var t=$("input[name=etype0]:checked").val();router.navigate("#/stores/cities/"+$qo.cityname+"-"+$qo.cityguid+"-"+$qo.cityid+"-"+t+"-1",!0),e.stopPropagation()}}),SponsoredStoreListView=Backbone.View.extend({initialize:function(e){this.options=e},events:{"click #ratecardsdrop":"ratecarddrop","click #photosdrop":"photodrop","click #reviewsdrop":"reviewdrop","click #trustsdrop":"trustdrop"},render:function(){var e=_.template($("#sponsored-store-list").html()),t=e({sponsoredStores:this.options.sponsoredStores,qo:this.options.qo});this.$el.html(t).trigger("create")},ratecarddrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new RateCardView({ratecards:getRateCard($datas),el:"#rate-"+$qo.storeID});$("#rate-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},photodrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new StorePhotoView({storephotos:getStorePhoto($datas),el:"#photo-"+$qo.storeID});$("#photo-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},reviewdrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new ReviewsView({reviews:getStoreReview($datas),el:"#review-"+$qo.storeID});$("#review-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},trustdrop:function(e){var t=this.getKeys(e).attr("data-value").split("-");$qo.storeID=t[0],$qo.storeguid=t[1],timeoutId||(timeoutId=!0,window.setTimeout(function(){$datas={gid:$qo.storeguid,id:$qo.storeID};var e=new TrustsView({data:getStoreTrust($datas),el:"#trust-"+$qo.storeID});$("#trust-"+$qo.storeID).append(e.render()),timeoutId=!1},500))},getKeys:function(e){return $(e.currentTarget).parent()}}),StoreAdminView=Backbone.View.extend({el:".main-container",initialize:function(e){this.options=e},render:function(){}}),StoreProfile=Backbone.View.extend({el:".main-container-top",bl:"#otp .modal-content",elphotos:".rate-card",initialize:function(e){this.options=e,$(window).scroll(this.detect_scroll)},events:{"mouseenter .shareicons":"showshareicons","mouseleave .services-header":"hideshareicons","click #rate-rev-top":"reviewmenue","click #gomap":"gotomap","click #favourite":"favourite","click #checkin":"checkin","click #rateus>span":"rateus","click #publish":"publishReview","click #salonia":"saloni","click #pba":"pb","click #naa":"na","click #reqtobook":"booking"},render:function(){$("#ishare").empty();var e=_.template($("#parlor-profile-template").html()),t=e({data:this.options.data,qo:this.options.qo});this.$el.html(t).trigger("create"),$(".overlay").fadeOut(),$("html, body").animate({scrollTop:0}),$("title").html("LookPlex - "+this.options.data.storename),$('[data-toggle="popover"]').popover();var o=new TrustsView({data:this.options.data});$("#trust").append(o.render()),$datas={gid:$qo.storeguid,id:$qo.storeID};var i=new RateCardView({ratecards:getRateCard($datas)});$("#rate-card").append(i.render());var a=new StorePhotoView({storephotos:getStorePhoto($datas)});$("#store-photo").append(a.render());var n=_.find(this.options.data.custactList,function(e){return"Comment"==e.activity}),r=_.find(this.options.data.custactList,function(e){return"Bookmark"==e.activity}),s=_.find(this.options.data.custactList,function(e){return"Checkin"==e.activity});n&&$("#rate-rev-top").addClass("marked"),r&&$("#favourite").addClass("marked"),s&&$("#checkin").addClass("marked"),this.postRender()},booknext:function(e){console.log(e)},detect_scroll:function(){if(scroll=$(window).scrollTop(),$reviewnotrenderd&&scroll>=1300){var e=new ReviewsView({reviews:getStoreReview($datas)});$("#store-reviews").append(e.render()),$reviewnotrenderd=!1}else if($mapnotrenderd&&scroll>=1300){var t={center:new google.maps.LatLng($lat,$log),zoom:14,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL},mapTypeId:google.maps.MapTypeId.ROADMAP},o=new google.maps.Map(document.getElementById("googleMap"),t),i=new google.maps.LatLng($lat,$log);new google.maps.Marker({position:i,map:o,title:"LookPlex Store"});$mapnotrenderd=!1}},postRender:function(){(new OTPSlot).render(),$('[data-toggle="tooltip"]').tooltip()},booking:function(e){$user.displayName?($("#otp").modal("show"),this.generateDates()):$("#login").modal("show")},generateDates:function(){var e=new Date,t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=["January","February","March","April","May","June","July","August","September","October","November","December"],i=[31,28,31,30,31,30,31,31,30,31,30,31];e.getFullYear()%4==0&&(i[1]=29);for(var a=[e.getDate()],n=e.getDay(),r=o[e.getMonth()],s=e.getMonth(),c=["Today -  "+this.ordinal_suffix_of(a[0])+" "+r],l=e.getFullYear(),d=[s+"/"+a[0]+"/"+l],u=1;14>u;u++)console.log(e.getMonth()),a[u-1]+1>i[s]?(a[u]=1,s+=1,s>11?(r=o[0],s=0,l+=1):r=o[s]):a[u]=a[u-1]+1,n>5&&(n=-1),n++,c[u]=(1==u?"Tomorrow":t[n])+" - "+this.ordinal_suffix_of(a[u])+" "+r,d[u]=parseInt(s)+1+"/"+a[u]+"/"+l;for(var p="",u=0;u<c.length-7;u++)p+="<a class='list-group-item' onclick='clickedondate(\""+c[u]+"\")' value='"+d[u]+"'>"+c[u]+"</a>";$("#dates").html(p),p="";for(var u=7;u<c.length;u++)p+="<a class='list-group-item' onclick='clickedondate(\""+c[u]+"\")' value='"+d[u]+"'>"+c[u]+"</a>";$("#dates1").html(p),$(".bookcontents").eq(0).addClass("showing"),console.log(c)},ordinal_suffix_of:function(e){var t=e%10,o=e%100;return 1==t&&11!=o?e+"st":2==t&&12!=o?e+"nd":3==t&&13!=o?e+"rd":e+"th"},saloni:function(e){e.preventDefault(),$(".nav-tabs a").click(function(){$(this).tab("show")})},pb:function(e){e.preventDefault(),$(".nav-tabs a").click(function(){$(this).tab("show")})},na:function(e){e.preventDefault(),$(".nav-tabs a").click(function(){$(this).tab("show")})},publishReview:function(e){var t=this.options.data;if($("#reviewerror").empty(),$user.displayName)if(0!=$rate){var o=$("textarea#comment").val();if(o.length>100){$data={storeguid:$qo.storeguid,storeid:$qo.storeID,rating:$rate,comment:o};var i=saveReview($data,1);i.success(function(){$("textarea#comment").val("");var e=_.find(t.custactList,function(e){return"Comment"==e.activity});e.stringComment||$("#rev").html(parseInt($("#rev").html())+1)})}else $("#reviewerror").append('<center><div class="errormsg col-md-12">Review is too short. Please review in more than 100 characters</div></center>')}else $("#reviewerror").append('<center><div class="errormsg col-md-12">You need to rate us :), before submitting the review</div></center>');else $("#login").modal("show")},rateus:function(e){this.options.data;if($user.displayName){$rate=$(e.currentTarget).attr("data-value");for(var t=5;t>0;t--)$rate>=t?$("#star"+t).addClass("fa fa-star-o fa-star-active").removeClass("star"):$("#star"+t).removeClass("fa fa-star-o fa-star-active").addClass("star");$data={storeguid:$qo.storeguid,storeid:$qo.storeID,rating:$rate};var o=saveReview($data,2);o.success(function(){!$(".screen-menu-rate.marked").length>0&&$("#rat").html(parseInt($("#rat").html())+1)})}else $("#login").modal("show")},showshareicons:function(e){$(".shareicons>a").removeClass("hidden")},hideshareicons:function(){$(".shareicons>a").addClass("hidden")},reviewmenue:function(){$("html, body").animate({scrollTop:$("#store-reviews").offset().top-90},700)},trustmenue:function(){$("html, body").animate({scrollTop:$("#trust").offset().top-90},700)},gotomap:function(e){e.preventDefault(),$("html, body").animate({scrollTop:$("#googleMap").offset().top-120},700)},encapsulate:function(e){return $(".nav-list>h4.active").removeClass("active"),$(".nav-contents>div.active").removeClass("active").fadeOut(),$(e.currentTarget).addClass("active"),$(e.currentTarget).attr("data-to")},favourite:function(e){var t=_.find(this.options.data.custactList,function(e){return"Bookmark"==e.activity});$user.displayName?t?($("#favourite i").toggleClass("fa-bookmark fa-circle-o-notch fa-spin"),deleteFavourite({storeguid:$qo.storeguid,storeid:$qo.storeID}).success(function(){$("#favourite i").toggleClass("fa-bookmark fa-circle-o-notch fa-spin"),$("#favourite").toggleClass("marked"),0!=$("#fav").html()&&$("#fav").html(parseInt($("#fav").html())-1),console.log($("#fav").html())}),this.options.data.custactList.splice(this.options.data.custactList.indexOf(t),1)):($("#favourite i").toggleClass("fa-bookmark fa-circle-o-notch fa-spin"),saveFavourite({storeguid:$qo.storeguid,storeid:$qo.storeID}).success(function(){$("#favourite i").toggleClass("fa-bookmark fa-circle-o-notch fa-spin"),$("#favourite").toggleClass("marked"),$("#fav").html(parseInt($("#fav").html())+1)}).error(function(){$("#favourite").html($text)}),this.options.data.custactList.push({activity:"Bookmark"})):$("#login").modal("show")},checkin:function(e){var t=_.find(this.options.data.custactList,function(e){return"Checkin"==e.activity});$user.displayName?t?($("#checkin i").toggleClass("fa-check fa-circle-o-notch fa-spin"),deleteCheckin({storeguid:$qo.storeguid,storeid:$qo.storeID}).success(function(){$("#checkin i").toggleClass("fa-check fa-circle-o-notch fa-spin"),$("#checkin").toggleClass("marked")}),this.options.data.custactList.splice(this.options.data.custactList.indexOf(t),1)):($("#checkin i").toggleClass("fa-check fa-circle-o-notch fa-spin"),saveCheckin({storeguid:$qo.storeguid,storeid:$qo.storeID}).success(function(){$("#checkin i").toggleClass("fa-check fa-circle-o-notch fa-spin"),$("#checkin").toggleClass("marked")}).error(function(e){console.log(e)}),this.options.data.custactList.push({activity:"Checkin"})):$("#login").modal("show")}}),RateCardView=Backbone.View.extend({el:"#rate-card",initialize:function(e){this.options=e},render:function(){var e=_.template($("#pp-ratecards").html()),t=e({ratecards:this.options.ratecards});this.$el.html(t).trigger("create")}}),StorePhotoView=Backbone.View.extend({el:"#store-photo",initialize:function(e){this.options=e},render:function(){var e=_.template($("#pp-photos").html()),t=e({storephotos:this.options.storephotos});this.$el.html(t).trigger("create")}}),ReviewsView=Backbone.View.extend({el:"#store-reviews",events:{"click .tips":"show_tips","click #tooltiprev":"tip"},initialize:function(e){this.options=e},render:function(){var e=_.template($("#pp-reviews").html()),t=e({reviews:this.options.reviews});this.$el.html(t).trigger("create"),$(".tooltiprev").tooltip()},tip:function(e){e.preventDefault()},show_tips:function(){}}),TrustsView=Backbone.View.extend({el:"#trust",initialize:function(e){this.options=e},render:function(){var e=_.template($("#trusts").html()),t=e({data:this.options.data});this.$el.html(t).trigger("create")}}),ModalView=Backbone.View.extend({el:".modal-container",initialize:function(e){this.options=e}}),OTPService=Backbone.View.extend({el:"#otpview",render:function(){var e=_.template($("#otpservice").html()),t=e();this.$el.html(t).trigger("create")}}),OTPSlot=Backbone.View.extend({el:"#otpview",events:{"click #datepickerr":"date"},render:function(){var e=_.template($("#otpslot").html()),t=e();this.$el.html(t).trigger("create")},date:function(){$("#datepickerr").datepicker()}}),OTPDetails=Backbone.View.extend({el:"#otpview",render:function(){var e=_.template($("#otpdetails").html()),t=e();this.$el.html(t).trigger("create")}}),OTPConfirm=Backbone.View.extend({el:"#otpview",render:function(){var e=_.template($("#otpconfirm").html()),t=e();this.$el.html(t).trigger("create")}}),OTPSuccess=Backbone.View.extend({el:"#otpview",render:function(){var e=_.template($("#successbooking").html()),t=e({booking:$booking});this.$el.html(t).trigger("create")}}),Workspace=Backbone.Router.extend({initialize:function(){Backbone.history.start()},routes:{"":"home","stores/:aid-:bid-:bgid-:cid-:did-:pid":"home_stores","stores/profile/:aid-:bid&:cid-:did&:eid-:sid-:guid":"store_profile","stores/profile/:sid-:guid":"store_profile","brands/profile/:bid-:bnm-:pid":"brand_profile","stores/services/:cnm-:cgd-:cid-:snm-:sid-:pid":"stores_service_wise","stores/cities/:cnm-:cgd-:cid-:snm-:sid-:pid":"stores_city_wise",freelisting:"free_listing",listing:"listing",about:"about",careers:"carreers",contactus:"contact_us",advertise:"advertise",storeadmin:"storeadmin",privacypolicy:"privacypolicy",haircare:"haircare",skincare:"skincare",fitness:"fitness",makeup:"makeup",diet:"diet",termsofservice:"termsofservice",profile:"profile"},home:function(){(new HomeView).render(),(new HeaderNoSearchBar).render(),(new HomeViewMidRibbon).render(),(new HomeViewBottom).render(),$("html, body").animate({scrollTop:0},500),$("title").html("Book beauty, wellness & fitness appointments online - Lookplex"),this.resetMetas()},stores_service_wise:function(e,t,o,i,a,n){$(".full-width-container").empty(),$(".main-container-bottom").empty(),$qo.catname=i,$qo.cid=a,$qo.cityname=e,$qo.cityid=o,$qo.cityguid=t,$qo.pageid=n,2==$qo.cid?$qo.cid="2,4,5":7==$qo.cid?$qo.cid="6,7":14==$qo.cid&&($qo.cid="12,14");var r=new SponsoredStoreView({sid:$qo.cid,snm:$qo.catname});r.render(),$datas={cityid:$qo.cityid,catids:$qo.cid,sortby:"none",cityguid:$qo.cityguid,startindex:1+10*($qo.pageid-1),endindex:10*($qo.pageid-1)+10};var s=new SponsoredCollection;getSponsoredStores(s,1)},stores_city_wise:function(e,t,o,i,a,n){$(".full-width-container").empty(),$(".main-container-bottom").empty(),$qo.cityname=e,$qo.catname=i,$qo.cid=a,$qo.cityid=o,$qo.cityguid=t,$qo.pageid=n,2==$qo.cid?$qo.cid="2,4,5":7==$qo.cid?$qo.cid="6,7":14==$qo.cid&&($qo.cid="12,14");var r=new SponsoredCityStoreView({cnm:$qo.cityname,cid:$qo.cityid});r.render(),$datas={cityid:$qo.cityid,catids:$qo.cid,sortby:"none",cityguid:$qo.cityguid,startindex:1+10*($qo.pageid-1),endindex:10*($qo.pageid-1)+10};var s=new SponsoredCollection;getSponsoredStores(s,1)},home_stores:function(e,t,o,i,a,n){$(".full-width-container").empty(),$(".main-container-bottom").empty(),$qo.blockname=e,$qo.blockid=t,$qo.blockguid=o,$qo.catname=i,$qo.catid=a,$qo.pageid=n,writeallvariables(),$datas="",2==$qo.catid?$qo.catid="2,4,5":7==$qo.catid?$qo.catid="6,7":14==$qo.catid&&($qo.catid="12,14"),1==$qo.isFiltered?$datas={blockid:$qo.blockid,blockguid:$qo.blockguid,catid:$qo.catid,brandname:$qo.brandname,aminities:$qo.morefilters,startindex:1+10*($qo.pageid-1),endindex:10*($qo.pageid-1)+10,sortby:"none"}:$datas={blockid:$qo.blockid,blockguid:$qo.blockguid,catid:$qo.catid,sortby:"none",startindex:1+10*($qo.pageid-1),endindex:10*($qo.pageid-1)+10};var r=new SearchView({aid:$qo.blockname,bid:$qo.blockguid,cid:$qo.catname,did:$qo.catid});r.render(),$("#ishare").empty(),$("html, body").animate({scrollTop:90},0),$("title").html("Best "+$qo.catname+"s near "+$qo.blockname+" on Lookplex. Book appointments online, get discounts, latest offers, photos and rate cards"),this.resetMetas()},brand_profile:function(e,t,o){$(".how-it-works").slideUp(),$(".full-width-container").empty(),$(".main-container-bottom").empty(),$qo.pageid=o;var i=new HeaderSearchBar;i.render(),$qo.brandname=t.split("_").join(" "),$qo.brandid=e,new BrandView({qo:$qo}).render(),$datas={brandid:e,startindex:1,endindex:9};var a=new BrandStoreCollection;getSponsoredStores(a,1)},store_profile:function(e,t){var o=this;$(".how-it-works").slideUp(),$(".full-width-container").empty(),$(".main-container-bottom").empty(),$qo.storeguid=t,$qo.storeID=e,$data={guid:t,storeid:e},$.ajax({data:$data,type:"POST",cache:!1,url:$ROOT_URL+"/getstoredetails",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:function(){$(".overlay").fadeIn();var e=new HeaderSearchBar;e.render()},success:function(e){var t=new StoreProfile({data:e,qo:$qo});t.render(),o.storeMetas(e),$(".overlay").fadeOut(),(null!=e.coordinate||void 0!=e.coordinate)&&($lat=parseFloat(e.coordinate.toString().split(",")[0]),$log=parseFloat(e.coordinate.toString().split(",")[1])),$booking.storename=e.storename,$booking.storeaddress=e.address,$temp=e.address.split(","),$("title").html(e.storename+" in "+$temp[$temp.length-2]+", "+$temp[$temp.length-1]+" - Book appointment online on Lookplex")},error:function(e){$(".overlay").fadeOut()}})},resetMetas:function(){$("meta[property='og:description']").attr("content","Lookplex is a leading online platform to book beauty, fitness and wellness services with spas, salons, gyms, makeup artists, slimming centres, yoga studios, tattoo artists and more. Book now!."),$("meta[property='og:image']").attr("content","https://static.lookplex.com/images/1.2/forshare.jpg"),$("meta[property='og:title']").attr("content","LET'S LOOK NEW TODAY!")},storeMetas:function(e){$("meta[property='og:description']").attr("content",e.description),$("meta[property='og:image']").attr("content",e.coverUrl),$("meta[property='og:title']").attr("content",e.storename)},profile:function(){(new HeaderSearchBar).render(),$user.displayName?($(".overlay").fadeIn(),$(".full-width-container").empty(),$(".main-container-bottom").empty(),(new ProfileView).render(),renderTemplate("user-profile-info",null),$(".overlay").fadeOut()):$("#login").modal("show")},free_listing:function(){$(".main-container-top").empty(),$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/listing.html","#free-listing-template",".hoo>tbody>tr>td>select","#timing-options")},listing:function(){$("#hiwdiv").empty(),$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/freelisting.html","#listing-template",".hoo>tbody>tr>td>select","#timing-options")},carreers:function(){$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/carreers.html","#carreers")},about:function(){$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("/templates/about.html","#about")},contact_us:function(){$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/contactus.html","#contact_us")},advertise:function(){$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/advertise.html","#advertise")},storeadmin:function(){$(".full-width-container").empty(),$(".main-container-bottom").empty();var e=new StoreAdminView;e.render()},termsofservice:function(){$("#login").modal("hide"),$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/tos.html","#tos")},privacypolicy:function(){$("#login").modal("hide"),$(".full-width-container").empty(),$(".main-container-bottom").empty(),template_loader("templates/privacypolicy.html","#privacypolicy")}}),router=new Workspace;